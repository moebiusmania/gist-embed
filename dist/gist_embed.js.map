{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/jsonp.js","webpack:///./src/libs.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","store","timeoutId","head","document","getElementsByTagName","options","timeout","jsonpCallback","jsonpCallbackFunction","createCallback","Date","now","Math","ceil","random","getRandom","maybeClearTimeout","id","clearTimeout","clearFunction","window","e","undefined","script","getElementById","removeChild","removeScript","jsonp","_url","Promise","resolve","reject","callback","response","ok","json","params","indexOf","url","createElement","setAttribute","charset","appendChild","setTimeout","Error","addEventListener","libs","user","uuid","then","res","data","obj","assign","extend","loading","src_GistEmbed","HTMLElement","[object Object]","height","this","getAttribute","innerHTML","stylesheet","div","render","init","customElements","define"],"mappings":"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","file":"gist_embed.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const store = {\r\n  timeoutId: null,\r\n  head: document.getElementsByTagName('head')[0],\r\n  options: {\r\n    timeout: 5000,\r\n    jsonpCallback: 'callback',\r\n    jsonpCallbackFunction: null\r\n  }\r\n};\r\n\r\nconst getRandom = () => Math.ceil(Math.random() * 100000);\r\n\r\nconst createCallback = () => `jsonp_${Date.now()}_${getRandom()}`;\r\n\r\nconst maybeClearTimeout = id => id ? clearTimeout(id) : null;\r\n\r\nconst removeScript = id => {\r\n  const script = document.getElementById(id);\r\n  if (script) {\r\n    store.head.removeChild(script);\r\n  }\r\n};\r\n\r\nconst clearFunction = (name, id) => {\r\n  try {\r\n    delete window[name];\r\n  } catch (e) {\r\n    window[name] = undefined;\r\n  }\r\n  removeScript(id);\r\n};\r\n\r\nconst fetchJsonp = (_url, options = {}) => {\r\n  const timeout = options.timeout || store.options.timeout;\r\n  const jsonpCallback = options.jsonpCallback || store.options.jsonpCallback;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const callback = options.jsonpCallbackFunction || createCallback();\r\n    const id = `${jsonpCallback}_${callback}`;\r\n\r\n    window[callback] = response => {\r\n      resolve({\r\n        ok: true,\r\n        // Keep consistent with fetch API\r\n        json: () => Promise.resolve(response)\r\n      });\r\n\r\n      maybeClearTimeout(store.timeoutId);\r\n      clearFunction(callback, id);\r\n    };\r\n\r\n    // Check if the user set their own params, and if not add a ? to start a list of params\r\n    const params = (_url.indexOf('?') === -1) ? '?' : '&';\r\n    const url = _url + params;\r\n\r\n    const script = document.createElement('script');\r\n    script.setAttribute('src', `${url}${jsonpCallback}=${callback}`);\r\n    if (options.charset) {\r\n      script.setAttribute('charset', options.charset);\r\n    }\r\n    script.id = id;\r\n    store.head.appendChild(script);\r\n\r\n    store.timeoutId = setTimeout(() => {\r\n      reject(new Error(`JSONP request to ${_url} timed out`));\r\n\r\n      clearFunction(callback, id);\r\n      window[callback] = () => clearFunction(callback, id);\r\n    }, timeout);\r\n\r\n    // Caught if got 404/500\r\n    script.addEventListener('error', () => {\r\n      reject(new Error(`JSONP request to ${_url} failed`));\r\n\r\n      clearFunction(callback, id);\r\n      maybeClearTimeout(store.timeoutId);\r\n    });\r\n  });\r\n};\r\n\r\nexport default fetchJsonp;\r\n","\r\nimport jsonp from './jsonp';\r\n\r\nconst extend = (obj, params) => Object.assign({}, obj, params);\r\n\r\nexport default (user, uuid) => {\r\n  const url = `https://gist.github.com/${user}/${uuid}.json`;\r\n\r\n  return jsonp(url)\r\n    .then(res => res.json())\r\n    .then(data => extend(data, {loading: false}));\r\n};\r\n","\r\nimport getData from './libs';\r\n\r\nexport default class GistEmbed extends HTMLElement {\r\n  render(data) {\r\n    const height = this.getAttribute('height') || 50;\r\n\r\n    this.innerHTML = `\r\n      <link rel=\"stylesheet\" href=\"${data.stylesheet}\">\r\n      <div style=\"min-height: ${height}px\">${data.div}</div>\r\n    `;\r\n  }\r\n\r\n  init() {\r\n    const user = this.getAttribute('user') || '';\r\n    const uuid = this.getAttribute('uuid') || '';\r\n\r\n    getData(user, uuid)\r\n      .then(data => this.render(data));\r\n  }\r\n\r\n  connectedCallback() {\r\n    this.init();\r\n  }\r\n}\r\n\r\ncustomElements.define('gist-embed', GistEmbed);\r\n"],"sourceRoot":""}