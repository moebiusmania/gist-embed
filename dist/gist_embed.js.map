{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/fetchjsonp.js","webpack:///./src/libs.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","defaultOptions","createCallback","Date","now","Math","ceil","random","getRandom","maybeClearTimeout","id","clearTimeout","clearFunction","functionName","window","e","undefined","removeScript","console","log","script","document","getElementById","getElementsByTagName","removeChild","fetchjsonp","_url","options","timeout","jsonpCallback","timeoutId","Promise","resolve","reject","callbackFunction","jsonpCallbackFunction","scriptId","response","ok","json","params","indexOf","url","jsonpScript","createElement","setAttribute","charset","appendChild","setTimeout","Error","addEventListener","libs","user","uuid","then","res","data","obj","assign","extend","loading","src_GistEmbed","HTMLElement","[object Object]","height","this","getAttribute","innerHTML","stylesheet","div","render","init","customElements","define"],"mappings":"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","file":"gist_embed.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const defaultOptions = {\r\n  timeout: 5000,\r\n  jsonpCallback: 'callback',\r\n  jsonpCallbackFunction: null\r\n};\r\n\r\nconst getRandom = () => Math.ceil(Math.random() * 100000);\r\n\r\nconst createCallback = () => `jsonp_${Date.now()}_${getRandom()}`;\r\n\r\nconst maybeClearTimeout = id => id ? clearTimeout(id) : null;\r\n\r\nconst clearFunction = functionName => {\r\n  try {\r\n    delete window[functionName];\r\n  } catch (e) {\r\n    window[functionName] = undefined;\r\n  }\r\n};\r\n\r\nconst removeScript = id => {\r\n  console.log(id);\r\n  const script = document.getElementById(id);\r\n  if (script) {\r\n    document.getElementsByTagName('head')[0].removeChild(script);\r\n  }\r\n};\r\n\r\nconst fetchJsonp = (_url, options = {}) => {\r\n  const timeout = options.timeout || defaultOptions.timeout;\r\n  const jsonpCallback = options.jsonpCallback || defaultOptions.jsonpCallback;\r\n\r\n  let timeoutId;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const callbackFunction = options.jsonpCallbackFunction || createCallback();\r\n    const scriptId = `${jsonpCallback}_${callbackFunction}`;\r\n\r\n    window[callbackFunction] = response => {\r\n      resolve({\r\n        ok: true,\r\n        // Keep consistent with fetch API\r\n        json: () => Promise.resolve(response)\r\n      });\r\n\r\n      maybeClearTimeout(timeoutId);\r\n\r\n      removeScript(scriptId);\r\n      clearFunction(callbackFunction);\r\n    };\r\n\r\n    // Check if the user set their own params, and if not add a ? to start a list of params\r\n    const params = (_url.indexOf('?') === -1) ? '?' : '&';\r\n    const url = _url + params;\r\n\r\n    const jsonpScript = document.createElement('script');\r\n    jsonpScript.setAttribute('src', `${url}${jsonpCallback}=${callbackFunction}`);\r\n    if (options.charset) {\r\n      jsonpScript.setAttribute('charset', options.charset);\r\n    }\r\n    jsonpScript.id = scriptId;\r\n    document.getElementsByTagName('head')[0].appendChild(jsonpScript);\r\n\r\n    timeoutId = setTimeout(() => {\r\n      reject(new Error(`JSONP request to ${_url} timed out`));\r\n\r\n      clearFunction(callbackFunction);\r\n      removeScript(scriptId);\r\n      window[callbackFunction] = () => clearFunction(callbackFunction);\r\n    }, timeout);\r\n\r\n    // Caught if got 404/500\r\n    jsonpScript.addEventListener('error', () => {\r\n      reject(new Error(`JSONP request to ${_url} failed`));\r\n\r\n      clearFunction(callbackFunction);\r\n      removeScript(scriptId);\r\n      maybeClearTimeout(timeoutId);\r\n    });\r\n  });\r\n};\r\n\r\nexport default fetchJsonp;\r\n","\r\nimport jsonp from './fetchjsonp';\r\n\r\nconst extend = (obj, params) => Object.assign({}, obj, params);\r\n\r\nexport default (user, uuid) => {\r\n  const url = `https://gist.github.com/${user}/${uuid}.json`;\r\n\r\n  return jsonp(url)\r\n    .then(res => res.json())\r\n    .then(data => extend(data, {loading: false}));\r\n};\r\n","\r\nimport getData from './libs';\r\n\r\nexport default class GistEmbed extends HTMLElement {\r\n  render(data) {\r\n    const height = this.getAttribute('height') || 50;\r\n\r\n    this.innerHTML = `\r\n      <link rel=\"stylesheet\" href=\"${data.stylesheet}\">\r\n      <div style=\"min-height: ${height}px\">${data.div}</div>\r\n    `;\r\n  }\r\n\r\n  init() {\r\n    const user = this.getAttribute('user') || '';\r\n    const uuid = this.getAttribute('uuid') || '';\r\n\r\n    getData(user, uuid)\r\n      .then(data => this.render(data));\r\n  }\r\n\r\n  connectedCallback() {\r\n    this.init();\r\n  }\r\n}\r\n\r\ncustomElements.define('gist-embed', GistEmbed);\r\n"],"sourceRoot":""}